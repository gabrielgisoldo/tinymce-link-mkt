tinymce.PluginManager.add("link-mkt",function(o,t){function e(t){if(t.match(new RegExp(/^rgb\(\d{1,3},\s?\d{1,3},\s?\d{1,3}\)/g)))return"#"+t.match(new RegExp(/\d{1,3}/g)).map(function(t){return 1==(t=parseInt(t).toString(16)).length?"0"+t:t}).join("");if(t.match(/^#[a-zA-Z0-9]{3,6}/g))return t;throw"WTF is this!"}function n(t){for(var e in this.node=void 0!==t?t:o.dom.create("a"),this.default={href:"",title:"",target:"",rel:"",dataurl:"",type:""},this.default)this[e]=void 0!==this.node.getAttribute(e)&&this.node.getAttribute(e)?this.node.getAttribute(e):this.default[e]}var i={},r={url_wrapper:o.settings.link_wrapper?o.settings.link_wrapper:""};n.prototype.formatLink=function(){if(r.url_wrapper){temp=r.url_wrapper,to_rep=r.url_wrapper.match(new RegExp(/%\w+%/g));for(var t=0;t<to_rep.length;t++)attr=to_rep[t].split("%").join(""),temp=temp.replace(to_rep[t],this[attr]?this[attr]:"");this.href=temp}else this.href=this.dataurl},n.prototype.makeTab=function(){return{name:"tab_url",title:"Link",items:[{type:"input",name:"href",label:"URL:"},{type:"input",name:"title",label:"Title:"},{type:"selectbox",name:"target",label:"Open link on...",items:[{value:"_blank",text:"New Window"},{value:"",text:"Actual Window"}]}]}},n.prototype.makeInit=function(){i.href=this.dataurl,i.title=this.title,i.target=this.target},n.prototype.getHTML=function(t){return this.node.href=this.href,this.node.title=this.title,this.node.target=this.target,this.node.rel=this.rel,this.node.type=this.type,this.node.setAttribute("dataurl",this.dataurl),t?this.node.outerHTML:this.node},n.prototype.update=function(t){for(var e in t)void 0!==this[e]&&(this[e]=t[e]);"_blank"==this.target&&(this.rel="noopener noreferer"),this.dataurl=this.href},n.prototype.setChildren=function(t){this.node.innerHTML="",this.node.appendChild(t)},n.prototype.getChildren=function(t){return this.node.childNodes[0]},n.prototype.checkURL=function(){if(this.href)try{new URL(this.href)}catch(t){return!1}return!0};function s(t){for(var e in this.node=void 0!==t?t:o.dom.create("img"),this.default={src:"",style:""},this.default)this[e]=void 0!==this.node.getAttribute(e)&&this.node.getAttribute(e)?this.node.getAttribute(e):this.default[e]}s.prototype.makeTab=function(){return{name:"tab_url_conf_img",title:"Image",items:[{type:"input",name:"src",label:"Image source link:"}]}},s.prototype.makeInit=function(){i.src=this.src},s.prototype.getHTML=function(t){return this.node.src=this.src,this.node.style=this.style,t?this.node.outerHTML:this.node},s.prototype.update=function(t){for(var e in t)void 0!==this[e]&&(this[e]=t[e])},s.prototype.checkURL=function(){if(this.src)try{new URL(this.src)}catch(t){return!1}return!0};function a(t){this.node=void 0!==t?t:o.dom.create("span"),this.default={btnText:"Button",innerText:"",btnBgcolor:"#FFF",btnColor:"#000",btnBorderSize:"1px",btnBorderColor:"#000",btnBorderRadius:"40px",btnDisplay:"inline-block",btnPadding:"10px",btnFontWeight:"bold",btnTextDecoration:"none",btnBorderStyle:"solid",btnCursor:"pointer"},this.innerText=void 0!==this.node.innerText&&this.node.innerText?this.node.innerText:this.default.innerText,this.btnBgcolor=void 0!==this.node.style.backgroundColor&&this.node.style.backgroundColor?e(this.node.style.backgroundColor):this.default.btnBgcolor,this.btnColor=void 0!==this.node.style.color&&this.node.style.color?e(this.node.style.color):this.default.btnColor,this.btnBorderSize=void 0!==this.node.style.borderWidth&&this.node.style.borderWidth?this.node.style.borderWidth:this.default.btnBorderSize,this.btnBorderColor=void 0!==this.node.style.borderColor&&this.node.style.borderColor?e(this.node.style.borderColor):this.default.btnBorderColor,this.btnBorderRadius=void 0!==this.node.style.borderRadius&&this.node.style.borderRadius?this.node.style.borderRadius:this.default.btnBorderRadius,this.btnDisplay=void 0!==this.node.style.display&&this.node.style.display?this.node.style.display:this.default.btnDisplay,this.btnPadding=void 0!==this.node.style.padding&&this.node.style.padding?this.node.style.padding:this.default.btnPadding,this.btnFontWeight=void 0!==this.node.style.fontWeight&&this.node.style.fontWeight?this.node.style.fontWeight:this.default.btnFontWeight,this.btnTextDecoration=void 0!==this.node.style.textDecoration&&this.node.style.textDecoration?this.node.style.textDecoration:this.default.btnTextDecoration,this.btnBorderStyle=void 0!==this.node.style.borderStyle&&this.node.style.borderStyle?this.node.style.borderStyle:this.default.btnBorderStyle,this.btnCursor=void 0!==this.node.style.cursor&&this.node.style.cursor?this.node.style.cursor:this.default.btnCursor,this.btnText=this.node.innerText,this.btnRounded=!!this.node.style.borderRadius,this.node=o.dom.create("span")}a.prototype.makeTab=function(){return{name:"tab_url_conf_button",title:"Button",items:[{type:"input",name:"btnText",label:"Text inside the button:"},{type:"htmlpanel",html:"<div></div>"},{type:"label",label:"Customization",items:[{type:"htmlpanel",html:"<div></div>"},{type:"colorinput",name:"btnBgcolor",label:"Background Color:"},{type:"colorinput",name:"btnColor",label:"Font Color"},{type:"input",name:"btnBorderSize",label:"Border Width:"},{type:"colorinput",name:"btnBorderColor",label:"Border color:"},{type:"checkbox",name:"btnBorderRadius",label:"Rounded Button",disabled:!1}]}]}},a.prototype.makeInit=function(){i.btnText=this.btnText,i.btnBgcolor=this.btnBgcolor,i.btnColor=this.btnColor,i.btnBorderSize=this.btnBorderSize,i.btnBorderColor=this.btnBorderColor,i.btnBorderRadius=!!this.btnRounded},a.prototype.getHTML=function(t){return this.node.innerText=this.btnText,this.node.style.backgroundColor=this.btnBgcolor,this.node.style.color=this.btnColor,this.node.style.borderWidth=this.btnBorderSize,this.node.style.borderColor=this.btnBorderColor,this.node.style.display=this.btnDisplay,this.node.style.padding=this.btnPadding,this.node.style.fontWeight=this.btnFontWeight,this.node.style.textDecoration=this.btnTextDecoration,this.node.style.borderRadius=this.btnBorderRadius?"40px":"",this.node.style.borderStyle=this.btnBorderStyle,this.node.style.cursor=this.btnCursor,t?this.node.outerHTML:this.node},a.prototype.update=function(t){for(var e in t)void 0!==this[e]&&(this[e]=t[e])};function d(t){for(var e in this.node=void 0!==t?t:o.dom.create("span"),this.default={text:"",innerText:""},this.default)this[e]=void 0!==this.node[e]&&this.node[e]?this.node[e]:this.default[e];this.text=this.innerText}d.prototype.makeTab=function(){return{name:"tab_url_conf_text",title:"Texto",items:[{type:"input",name:"text",label:"Texto to show as link:"}]}},d.prototype.makeInit=function(){i.text=this.text},d.prototype.getHTML=function(t){return this.node.innerText=this.text,this.node.style=this.style,t?this.node.outerHTML:this.node},d.prototype.update=function(t){for(var e in t)void 0!==this[e]&&(this[e]=t[e])};var h=function(t,e){return{title:"Insert/Edit Link",body:{type:"tabpanel",tabs:t},buttons:[{type:"cancel",text:"Cancel"},{type:"submit",text:"Save",primary:!0}],initialData:e,onSubmit:function(t){if(data=t.getData(),data.src?data.type="img":data.btnText?data.type="btn":data.type="txt",anchor.update(data),!anchor.checkURL())throw l("error","Link: Invalid URL.","warning"),"Invalid URL";if(anchor.formatLink(),"txt"==data.type)""==data.text&&(data.text=anchor.dataurl),text.update(data),anchor.setChildren(text.getHTML());else if("img"==data.type){if(image.update(data),!image.checkURL())throw l("error","Image: Invalid URL.","warning"),"Invalid image URL";anchor.setChildren(image.getHTML())}else"btn"==data.type&&(button.update(data),anchor.setChildren(button.getHTML()));i.new||("A"==o.selection.getNode().nodeName?o.dom.remove(o.selection.getNode()):o.dom.remove(o.selection.getNode().parentNode)),o.insertContent(anchor.getHTML(!0)),o.fire("input"),t.close()}}},l=function(t,e,n){o.windowManager.open({title:"",body:{type:"panel",items:[{type:"alertbanner",level:t||"info",text:e||"Default notification.",icon:n||"notice"}]},buttons:[{type:"cancel",text:"OK",primary:!0}]})};return o.ui.registry.addButton("link-mkt",{icon:"link",tooltip:"Insert/Edit Link",onAction:function(){o.windowManager.open((i={},tabs=[],"A"==o.selection.getNode().nodeName||"A"==o.selection.getNode().parentNode.nodeName?(console.log("Edit"),anchor=new n("A"==o.selection.getNode().nodeName?o.selection.getNode():o.selection.getNode().parentNode),anchor.makeInit(),tabs.push(anchor.makeTab()),"txt"==anchor.type?(text=new d(anchor.getChildren()),text.makeInit(),tabs.push(text.makeTab())):"img"==anchor.type?(image=new s(anchor.getChildren()),image.makeInit(),tabs.push(image.makeTab())):"btn"==anchor.type&&(button=new a(anchor.getChildren()),button.makeInit(),tabs.push(button.makeTab())),i.new=!1):(console.log("New"),anchor=new n,image=new s,button=new a,text=new d,anchor.makeInit(),text.makeInit(),image.makeInit(),button.makeInit(),i.new=!0,tabs.push(anchor.makeTab()),tabs.push(image.makeTab()),tabs.push(button.makeTab()),tabs.push(text.makeTab())),h(tabs,i)))}}),{getMetadata:function(){return{name:"link-mkt",url:"https://github.com/gabrielgisoldo/tinymce-link-mkt"}}}});
